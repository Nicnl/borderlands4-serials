package b4string

import (
	"borderlands_4_serials/lib/bit"
	"borderlands_4_serials/lib/helpers"
	"testing"

	"github.com/stretchr/testify/assert"
)

var tests = []struct {
	bin  string
	text string
}{
	{
		"00110  000101110100110011011001101111110110000010111011111110110100111001101100100111000010",
		"hello world!",
	},
	{
		"11101-00100  00010111010011001101100110111111011000001011101111111011010011100110110010011000001000010111010011001101100110111111011000001011101111111011010011100110110010011000001000010111010011001101100110111111011000001011101111111011010011100110110010011000001000010111010011001101100110111111011000001011101111111011010011100110110010011000001000010111010011001101100110111111011000001011101111111011010011100110110010011000001000010111010011001101100110111111011000001011101111111011010011100110110010011",
		"hello world hello world hello world hello world hello world hello world",
	},
}

func TestReadString(t *testing.T) {
	for _, tt := range tests {
		t.Run(tt.text, func(t *testing.T) {
			data := helpers.BinToBytes(tt.bin)
			br := bit.NewReader(data)
			val, err := Read(br)
			assert.NoError(t, err)
			assert.Equal(t, tt.text, val)
		})
	}
}
